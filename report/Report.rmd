---
author: Lisa Hu
output:
  pdf_document:
    fig_caption: yes
    toc: true
    toc_depth: 2
    number_sections: true
    keep_tex: true
    includes:
      before_body: title.sty
      in_header: header.sty
---
```{r include = FALSE}
# Copyright (c) 2022 Lisa Hu
# Licensed under GPLv3. See LICENSE
```

```{r setup, include = FALSE, warning = FALSE, message = FALSE}
#' Setup chunk
knitr::opts_chunk$set(cache = TRUE)
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_chunk$set(warning = FALSE)
knitr::opts_chunk$set(message = FALSE)
knitr::opts_chunk$set(error = FALSE)
BOSS_MODE <- TRUE

# Load all the packages
packages <- c("ggplot2", "readr", "ggpubr", "pander", "ggbiplot", "FSA", "latex2exp")
invisible(lapply(packages, library, character.only = T))

# Load external scripts
source("EDA_vars.R", local = knitr::knit_global())
```

\newpage
\pagenumbering{arabic}

# Introduction

https://www.gov.uk/government/statistics/cancer-survival-in-england-for-patients-diagnosed-between-2014-and-2018-and-followed-up-until-2019/cancer-survival-in-england-for-patients-diagnosed-between-2014-and-2018-and-followed-up-to-2019

\newpage
# Methods

\newpage
# Results
## Demographics
The patients were divided by diagnosis and the PDAC patients are further seperated by the stage of the disease. The number of samples per diagnosis and stage are shown in Table \ref{tab:demo}.
\noindent
\begin{table}[h]
  \begin{tabular}{p{0.2\linewidth}|ll|ll|lll}
    \multirow{2}{*}{\textbf{Sample type}} & \multicolumn{2}{l}{\textbf{Control}} & \multicolumn{2}{l}{\textbf{Benign}} & \multicolumn{3}{l}{\textbf{PDAC}}\tabularnewline
    \cline{2-8}
    {} & Sample & Sex & Sample & Sex & Sample & Sex & Cancer stage \tabularnewline
    \cline{1-8}
    \multirow{2}{*}{Urine (n=590)} & 183 & F = 115 & 208 & F = 101 & 209 & F = 83 & I-IIA = 27  II-IIB = 75 \tabularnewline
    {} & {} & M = 68 & & M = 107 & & M = 116 & III = 76  IV = 21 \tabularnewline
    \cline{1-8}
    \multirow{2}{*}{Plasma (n=350)} & 92 & F = 58 & 108 & F = 57 & 150 & F = 86 & I-IIA = 20  II-IIB = 60 \tabularnewline
    {} & {} & M = 34 & & M = 51 & & M = 64 & III = 65  IV = 5 \tabularnewline
  \end{tabular}
\caption{Demographics of the samples}
\label{tab:demo}
\end{table}

## REG1B outperforms REG1A in detecting early stage PDAC
Though the performance of REG1A and REG1B are very similar, REG1B outperformed REG1A when control and benign samples were compared to stage I-IIA PDAC samples (Kruskal-Wallis test; p < 0.001 & p < 0.0002). [Table \ref{tab:comp}] Therefor, all experiments following were performed using REG1B as part of the biomarker panel.

```{r reg-vs}
pander(comparison[,c(2,4,6)], split.tables = 100, booktabs = T,
       caption = "\\label{tab:comp}Adjusted p-values of Kruskal-Wallis test,
       Dunn's multiple comparisons; ns - not significant.
       The header shows the groups that were compared.")
pander(comparison[,c(1,3,5)], split.tables = 100, booktabs = T)
```

\newpage
## Correlation in urine biomarkers for different diagnosis groups
The biomarker panel was tested in a total of 590 urine samples (183 control, 208 benign, and 199 PDAC). According to the PCA, the LYVE1 and REG1B biomarkers are close related to eachother. Aside from that, the different diagnosis groups create clusters, meaning there is significant difference between the samples.

```{r, fig.cap = "\\label{fig:fig2}PCA plot showing the correlations between the biomarkers. Data is log transformed."}
ggbiplot(pca, obs.scale = 1, var.scale = 1, groups = factor(dataset$diagnosis),
         ellipse = TRUE, circle = FALSE, size = 0.1) +
  ggtitle("PCA of complete dataset") +
  guides(color = guide_legend(title = "Diagnosis"))
```

\newpage
# Conclusion
+ REG1A shows no significant difference when control samples are compared to PDAC stage I-IIA samples, though REG1B does show significance: REG1B outperforms REG1A in detecting PDAC in early stages.
+ LYVE1 and REG1B are closely related biomarkers. A good focus for the prediction following.

# Discussion

\newpage
# References
```{r references, child = 'references.rmd'}
```
